<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3&nbsp; Models for Binary Outcomes – Regression Models for Epidemiology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./count-regression.html" rel="next">
<link href="./Linear-models-overview.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6e4858b4921ffe5a9c7d897cee0e5447.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-cbfe9299f5caab731b93668de05d1c8d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-6e4858b4921ffe5a9c7d897cee0e5447.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-W625DGE908"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-W625DGE908', { 'anonymize_ip': true});
</script><script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean",
  "openSidebar": false,
  "enableExperimentalNewNoteButton": true
}
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="site_libs/plotly-binding-4.10.4/plotly.js"></script><script src="site_libs/typedarray-0.1/typedarray.min.js"></script><script src="site_libs/jquery-3.5.1/jquery.min.js"></script><link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="custom.scss">
</head>
<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./glms.html">Generalized Linear Models</a></li><li class="breadcrumb-item"><a href="./logistic-regression.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Models for Binary Outcomes</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">
      Regression Models for Epidemiology
      </a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/d-morrison/rme" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Regression-Models-for-Epidemiology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro-to-GLMs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./glms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Linear-models-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear (Gaussian) Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Models for Binary Outcomes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Models for Count Outcomes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-multilevel-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to multi-level models for correlated data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-to-event-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time to Event Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-to-survival-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction to Survival Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./proportional-hazards-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Proportional Hazards Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parametric-survival-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Parametric survival models</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendices-are-prereqs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Overview of Appendices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./math-prereqs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Mathematics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-MLEs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Introduction to Maximum Likelihood Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Introduction to Bayesian inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./common-mistakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Common Mistakes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Notation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-to-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Statistical computing in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CONTRIBUTING.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Contributing to `rme`</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#configuring-r" id="toc-configuring-r" class="nav-link active" data-scroll-target="#configuring-r">Configuring R</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements">Acknowledgements</a></li>
  <li>
<a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">3.1</span> Introduction</a>
  <ul class="collapse">
<li><a href="#logistic-regression-versus-linear-regression" id="toc-logistic-regression-versus-linear-regression" class="nav-link" data-scroll-target="#logistic-regression-versus-linear-regression"><span class="header-section-number">3.1.1</span> Logistic regression versus linear regression</a></li>
  </ul>
</li>
  <li><a href="#risk-estimation-and-prediction" id="toc-risk-estimation-and-prediction" class="nav-link" data-scroll-target="#risk-estimation-and-prediction"><span class="header-section-number">3.2</span> Risk estimation and prediction</a></li>
  <li>
<a href="#comparing-probabilities" id="toc-comparing-probabilities" class="nav-link" data-scroll-target="#comparing-probabilities"><span class="header-section-number">3.3</span> Comparing probabilities</a>
  <ul class="collapse">
<li><a href="#risk-differences" id="toc-risk-differences" class="nav-link" data-scroll-target="#risk-differences"><span class="header-section-number">3.3.1</span> Risk differences</a></li>
  <li><a href="#risk-ratios" id="toc-risk-ratios" class="nav-link" data-scroll-target="#risk-ratios"><span class="header-section-number">3.3.2</span> Risk ratios</a></li>
  <li><a href="#relative-risk-differences" id="toc-relative-risk-differences" class="nav-link" data-scroll-target="#relative-risk-differences"><span class="header-section-number">3.3.3</span> Relative risk differences</a></li>
  <li><a href="#changing-reference-groups-in-risk-comparisons" id="toc-changing-reference-groups-in-risk-comparisons" class="nav-link" data-scroll-target="#changing-reference-groups-in-risk-comparisons"><span class="header-section-number">3.3.4</span> Changing reference groups in risk comparisons</a></li>
  </ul>
</li>
  <li>
<a href="#odds-and-odds-ratios" id="toc-odds-and-odds-ratios" class="nav-link" data-scroll-target="#odds-and-odds-ratios"><span class="header-section-number">3.4</span> Odds and odds ratios</a>
  <ul class="collapse">
<li><a href="#odds-and-probabilities" id="toc-odds-and-probabilities" class="nav-link" data-scroll-target="#odds-and-probabilities"><span class="header-section-number">3.4.1</span> Odds and probabilities</a></li>
  <li><a href="#the-inverse-odds-function" id="toc-the-inverse-odds-function" class="nav-link" data-scroll-target="#the-inverse-odds-function"><span class="header-section-number">3.4.2</span> The inverse odds function</a></li>
  <li><a href="#odds-ratios" id="toc-odds-ratios" class="nav-link" data-scroll-target="#odds-ratios"><span class="header-section-number">3.4.3</span> Odds ratios</a></li>
  </ul>
</li>
  <li>
<a href="#the-logit-and-expit-functions" id="toc-the-logit-and-expit-functions" class="nav-link" data-scroll-target="#the-logit-and-expit-functions"><span class="header-section-number">3.5</span> The logit and expit functions</a>
  <ul class="collapse">
<li><a href="#the-logit-function" id="toc-the-logit-function" class="nav-link" data-scroll-target="#the-logit-function"><span class="header-section-number">3.5.1</span> The logit function</a></li>
  <li><a href="#the-expit-function" id="toc-the-expit-function" class="nav-link" data-scroll-target="#the-expit-function"><span class="header-section-number">3.5.2</span> The expit function</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/d-morrison/rme/edit/main/logistic-regression.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/d-morrison/rme/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/d-morrison/rme/blob/main/logistic-regression.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./glms.html">Generalized Linear Models</a></li><li class="breadcrumb-item"><a href="./logistic-regression.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Models for Binary Outcomes</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-Bernoulli-models" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Models for Binary Outcomes</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Logistic regression and variations</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Last modified: 2025-05-18: 6:45:14 (AM)</p>
    </div>
  </div>
  
    
  </div>
  


</header><hr>
<!-- ::: {.content-hidden when-format="revealjs"} --><hr>
<section id="configuring-r" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="configuring-r">Configuring R</h3>
<p>Functions from these packages will be used throughout this document:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://conflicted.r-lib.org/">conflicted</a></span><span class="op">)</span> <span class="co"># check for conflicting function definitions</span></span>
<span><span class="co"># library(printr) # inserts help-file output into markdown output</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/rmarkdown">rmarkdown</a></span><span class="op">)</span> <span class="co"># Convert R Markdown documents into a variety of formats.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rapporter.github.io/pander/">pander</a></span><span class="op">)</span> <span class="co"># format tables for markdown</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span> <span class="co"># graphics</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jonocarroll/ggeasy">ggeasy</a></span><span class="op">)</span> <span class="co"># help with graphics</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sinhrks/ggfortify">ggfortify</a></span><span class="op">)</span> <span class="co"># help with graphics</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span> <span class="co"># manipulate data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span> <span class="co"># `tibble`s extend `data.frame`s</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span> <span class="co"># `%&gt;%` and other additional piping tools</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org">haven</a></span><span class="op">)</span> <span class="co"># import Stata files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span> <span class="co"># format R output for markdown</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span> <span class="co"># Tools to help to create tidy data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span> <span class="co"># interactive graphics</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dobson</span><span class="op">)</span> <span class="co"># datasets from Dobson and Barnett 2018</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/">parameters</a></span><span class="op">)</span> <span class="co"># format model output tables for markdown</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org">haven</a></span><span class="op">)</span> <span class="co"># import Stata files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/">latex2exp</a></span><span class="op">)</span> <span class="co"># use LaTeX in R code (for figures and tables)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://fs.r-lib.org">fs</a></span><span class="op">)</span> <span class="co"># filesystem path manipulations</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span> <span class="co"># survival analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/survminer/index.html">survminer</a></span><span class="op">)</span> <span class="co"># survival analysis graphics</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">KMsurv</span><span class="op">)</span> <span class="co"># datasets from Klein and Moeschberger</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/">parameters</a></span><span class="op">)</span> <span class="co"># format model output tables for</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/webshot2/">webshot2</a></span><span class="op">)</span> <span class="co"># convert interactive content to static for pdf</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/">forcats</a></span><span class="op">)</span> <span class="co"># functions for categorical variables ("factors")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span> <span class="co"># functions for dealing with strings</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span> <span class="co"># functions for dealing with dates and times</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here are some R settings I use in this document:</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># delete any data that's already loaded into R</span></span>
<span></span>
<span><span class="fu"><a href="https://conflicted.r-lib.org/reference/conflicts_prefer.html">conflicts_prefer</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">)</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="co"># ggplot2::labs(col = "") +</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>      legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>      text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">'digits'</span> <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/panderOptions.html">panderOptions</a></span><span class="op">(</span><span class="st">"big.mark"</span>, <span class="st">","</span><span class="op">)</span></span>
<span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/panderOptions.html">panderOptions</a></span><span class="op">(</span><span class="st">"table.emphasize.rownames"</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/panderOptions.html">panderOptions</a></span><span class="op">(</span><span class="st">"table.split.table"</span>, <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://conflicted.r-lib.org/reference/conflicts_prefer.html">conflicts_prefer</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">)</span> <span class="co"># use the `filter()` function from dplyr() by default</span></span>
<span><span class="va">legend_text_size</span> <span class="op">=</span> <span class="fl">9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- ::: -->
<!-- https://www.overleaf.com/learn/latex/Using_colors_in_LaTeX#Named_colors_provided_by_the_xcolor_package -->
<!-- \def\or{\theta}  -->
<!-- doesn't work for some reason -->
<style>
.quarto-figure-center > figure {
text-align: center;
}
</style>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="acknowledgements" class="level3 unnumbered"><h3 class="unnumbered anchored" data-anchor-id="acknowledgements">Acknowledgements</h3>
<p>This content is adapted from:</p>
<ul>
<li>
<span class="citation" data-cites="dobson4e">Dobson and Barnett (<a href="references.html#ref-dobson4e" role="doc-biblioref">2018</a>)</span>, Chapter 7</li>
<li>
<span class="citation" data-cites="vittinghoff2e">Vittinghoff et al. (<a href="references.html#ref-vittinghoff2e" role="doc-biblioref">2012</a>)</span>, Chapter 5</li>
<li>
<a href="https://dmrocke.ucdavis.edu/">David Rocke</a>’s materials from the <a href="https://dmrocke.ucdavis.edu/Class/EPI204-Spring-2021/EPI204-Spring-2021.html">2021 edition of Epi 204</a>
</li>
<li>
<span class="citation" data-cites="NahhasIRMPHR">Nahhas (<a href="references.html#ref-NahhasIRMPHR" role="doc-biblioref">2024</a>)</span> <a href="https://www.bookdown.org/rwnahhas/RMPH/blr.html">Chapter 6</a>
</li>
</ul></section><section id="introduction" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">3.1</span> Introduction</h2>
<hr>
<!-- https://www.overleaf.com/learn/latex/Using_colors_in_LaTeX#Named_colors_provided_by_the_xcolor_package --><!-- \def\or{\theta}  --><!-- doesn't work for some reason --><div id="exr-def-logistic-regression" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.1</strong></span> What is logistic regression?</p>
</div>
<hr>
<div id="sol-def-logistic-regression" class="proof solution">
<p><span class="proof-title"><em>Solution 3.1</em>. </span></p>
<div id="def-logistic-regression" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.1</strong></span> <strong>Logistic regression</strong> is a framework for modeling <a href="./probability.html#def-binary">binary</a> outcomes, conditional on one or more <em>predictors</em> (a.k.a. <em>covariates</em>).</p>
</div>
</div>
<hr>
<div id="exr-binary-examples" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.2 (Examples of binary outcomes)</strong></span> What are some examples of binary outcomes in the health sciences?</p>
</div>
<hr>
<div id="sol-binary-examples" class="proof solution">
<p><span class="proof-title"><em>Solution 3.2</em>. </span>Examples of binary outcomes include:</p>
<ul>
<li>exposure (exposed vs unexposed)</li>
<li>disease (diseased vs healthy)</li>
<li>recovery (recovered vs unrecovered)</li>
<li>relapse (relapse vs remission)</li>
<li>return to hospital (returned vs not)</li>
<li>vital status (dead vs alive)</li>
</ul>
</div>
<hr>
<p>Logistic regression uses the <a href="./probability.html#def-bernoulli">Bernoulli</a> distribution to model the outcome variable, conditional on one or more covariates.</p>
<hr>
<div id="exr-def-bernoulli" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.3</strong></span> Write down a mathematical definition of the Bernoulli distribution.</p>
</div>
<hr>
<div id="sol-def-bernoulli" class="proof solution">
<p><span class="proof-title"><em>Solution 3.3</em>. </span>The <strong>Bernoulli distribution</strong> family for a random variable <span class="math inline">\(X\)</span> is defined as:</p>
<p><span class="math display">\[
\begin{aligned}
\Pr(X=x) &amp;= \mathbb{1}_{x\in \left\{0,1\right\}}\pi^x(1-\pi)^{1-x}\\
&amp;= \left\{{\pi, x=1}\atop{1-\pi, x=0}\right.
\end{aligned}
\]</span></p>
</div>
<hr>
<section id="logistic-regression-versus-linear-regression" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="logistic-regression-versus-linear-regression">
<span class="header-section-number">3.1.1</span> Logistic regression versus linear regression</h3>
<p>Logistic regression differs from linear regression, which uses the Gaussian (“normal”) distribution to model the outcome variable, conditional on the covariates.</p>
<hr>
<div id="exr-examples-linreg" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.4</strong></span> Recall: what kinds of outcomes is linear regression used for?</p>
</div>
<hr>
<div id="sol-examples-linreg" class="proof solution">
<p><span class="proof-title"><em>Solution 3.4</em>. </span>Linear regression is typically used for numerical outcomes that aren’t event counts or waiting times for an event.</p>
<p>Examples of outcomes that are often analyzed using linear regression include:</p>
<ul>
<li>weight</li>
<li>height</li>
<li>income</li>
<li>prices</li>
</ul>
</div>
<!-- https://www.overleaf.com/learn/latex/Using_colors_in_LaTeX#Named_colors_provided_by_the_xcolor_package -->
<!-- \def\or{\theta}  -->
<!-- doesn't work for some reason -->
</section></section><section id="risk-estimation-and-prediction" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="risk-estimation-and-prediction">
<span class="header-section-number">3.2</span> Risk estimation and prediction</h2>
<div class="notes">
<p>In Epi 203, you have already seen methods for modeling binary outcomes using one covariate that is also binary (such as exposure/non-exposure). In this section, we review one-covariate analyses, with a special focus on risk ratios and odds ratios, which are important concepts for interpreting logistic regression.</p>
</div>
<hr>
<div id="exm-oc-mi" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.1 (Oral Contraceptive Use and Heart Attack)</strong></span> &nbsp;</p>
<ul>
<li>Research question: how does oral contraceptive (OC) use affect the risk of myocardial infarction (MI; a.k.a. heart attack)?</li>
</ul>
<div class="notes">
<p>This was an issue when oral contraceptives were first developed, because the original formulations used higher concentrations of hormones. Modern OCs don’t have this issue.</p>
<p><a href="#tbl-oc-mi" class="quarto-xref">Table&nbsp;<span>3.1</span></a> contains simulated data for an imaginary follow-up (a.k.a. <em>prospective</em>) study in which two groups are identified, one using OCs and another not using OCs, and both groups are tracked for three years to determine how many in each groups have MIs.</p>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">oc_mi</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">OC</span>, <span class="op">~</span><span class="va">MI</span>, <span class="op">~</span><span class="va">Total</span>,</span>
<span>    <span class="st">"OC use"</span>, <span class="fl">13</span>, <span class="fl">5000</span>,</span>
<span>    <span class="st">"No OC use"</span>, <span class="fl">7</span>, <span class="fl">10000</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>`No MI` <span class="op">=</span> <span class="va">Total</span> <span class="op">-</span> <span class="va">MI</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">`No MI`</span>, .after <span class="op">=</span> <span class="va">MI</span><span class="op">)</span></span>
<span></span>
<span><span class="va">totals</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">oc_mi</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">MI</span>, <span class="va">`No MI`</span>, <span class="va">Total</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>OC <span class="op">=</span> <span class="st">"Total"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl_oc_mi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">oc_mi</span>, <span class="va">totals</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl_oc_mi</span> <span class="op">|&gt;</span> <span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-oc-mi" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-oc-mi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.1: Simulated data from study of oral contraceptive use and heart attack risk
</figcaption><div aria-describedby="tbl-oc-mi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">OC</th>
<th style="text-align: center;">MI</th>
<th style="text-align: center;">No MI</th>
<th style="text-align: center;">Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">OC use</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">4,987</td>
<td style="text-align: center;">5,000</td>
</tr>
<tr class="even">
<td style="text-align: center;">No OC use</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">9,993</td>
<td style="text-align: center;">10,000</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Total</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">14,980</td>
<td style="text-align: center;">15,000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<hr>
<div id="exr-probs" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.5</strong></span> Estimate the probabilities of MI for OC users and non-OC users in <a href="#exm-oc-mi" class="quarto-xref">Example&nbsp;<span>3.1</span></a>.</p>
</div>
<hr>
<div id="sol-compute-probs" class="proof solution">
<p><span class="proof-title"><em>Solution 3.5</em>. </span><span class="math display">\[\hat{\text{p}}(MI|OC) = \frac{13}{5000} = 0.0026\]</span></p>
<p><span class="math display">\[\hat{\text{p}}(MI|\neg OC) = \frac{7}{10000} = 7\times 10^{-4}\]</span></p>
</div>
<hr>
<div id="exr-def-controls" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.6</strong></span> What does the term “controls” mean in the context of study design?</p>
</div>
<hr>
<div id="sol-def-controls" class="proof solution">
<p><span class="proof-title"><em>Solution 3.6</em>. </span></p>
<div id="def-controls" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.2 (Two meanings of “controls”)</strong></span> Depending on context, “controls” can mean either:</p>
<ul>
<li>individuals who don’t experience an <em>exposure</em> of interest,</li>
<li>or individuals who don’t experience an <em>outcome</em> of interest.</li>
</ul>
</div>
</div>
<hr>
<div id="exr-controls-use-cases" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.7</strong></span> What types of studies do the two definitions of controls correspond to?</p>
</div>
<hr>
<div id="sol-controls-use-cases" class="proof solution">
<p><span class="proof-title"><em>Solution 3.7</em>. </span></p>
<div id="def-cases-retrospective" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.3 (cases and controls in retrospective studies)</strong></span> In <em>retrospective case-control studies</em>, participants who experience the outcome of interest are called <strong>cases</strong>, while participants who don’t experience that outcome are called <strong>controls</strong>.</p>
</div>
<div id="def-cases-prospective" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.4 (treatment groups and control groups in prospective studies)</strong></span> In <em>prospective studies</em>, the group of participants who experience the treatment or exposure of interest is called the <strong>treatment group</strong>, while the participants who receive the baseline or comparison treatment (for example, clinical trial participants who receive a placebo or a standard-of-care treatment rather than an experimental treatment) are called <strong>controls</strong>.</p>
</div>
</div>
</section><section id="comparing-probabilities" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="comparing-probabilities">
<span class="header-section-number">3.3</span> Comparing probabilities</h2>
<section id="risk-differences" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="risk-differences">
<span class="header-section-number">3.3.1</span> Risk differences</h3>
<div class="notes">
<p>The simplest comparison of two probabilities, <span class="math inline">\(\pi_1\)</span>, and <span class="math inline">\(\pi_2\)</span>, is the difference of their values:</p>
</div>
<div id="def-RD" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.5 (Risk difference)</strong></span> The <strong>risk difference</strong> of two probabilities, <span class="math inline">\(\pi_1\)</span>, and <span class="math inline">\(\pi_2\)</span>, is the difference of their values: <span class="math display">\[\delta(\pi_1,\pi_2) \stackrel{\text{def}}{=}\pi_1 - \pi_2\]</span></p>
</div>
<hr>
<div id="exm-RD" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.2 (Difference in MI risk)</strong></span> In <a href="#exm-oc-mi" class="quarto-xref">Example&nbsp;<span>3.1</span></a>, the maximum likelihood estimate of the difference in MI risk between OC users and OC non-users is:</p>
<p><span class="math display">\[
\begin{aligned}
\hat\delta(\pi(OC), \pi(\neg OC))
&amp;= \delta(\hat\pi(OC), \hat\pi(\neg OC))\\
&amp;= \hat\pi(OC) - \hat\pi(\neg OC)\\
&amp;= 0.0026 - 7\times 10^{-4}\\
&amp;= 0.0019
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="exr-interpret-rr" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.8 (interpreting risk differences)</strong></span> How can we interpret the preceding relative risk estimate in prose?</p>
</div>
<hr>
<div id="sol-interpret-rd" class="proof solution">
<p><span class="proof-title"><em>Solution 3.8</em> (interpreting risk differences). </span>“The difference in risk of MI between OC users and non-users was 0.0019.”</p>
<p>or</p>
<p>“The difference in risk of MI between OC users and non-users was 0.19 <a href="https://en.wikipedia.org/wiki/Percentage_point">percentage points</a>.”</p>
</div>
<div class="notes">
<p>See the note about working with percentages in the <a href="./notation.html#percent-sign">Appendix</a>.</p>
</div>
<hr></section><section id="risk-ratios" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="risk-ratios">
<span class="header-section-number">3.3.2</span> Risk ratios</h3>
<div id="exr-name-RR" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.9</strong></span> If <span class="math inline">\(\pi_1\)</span> and <span class="math inline">\(\pi_2\)</span> are two probabilities, what do we call the following ratio?</p>
<p><span class="math display">\[\rho(\pi_1,\pi_2) = \frac{\pi_1}{\pi_2}\]</span></p>
</div>
<hr>
<div id="sol-exr-name-RR" class="proof solution">
<p><span class="proof-title"><em>Solution 3.9</em>. </span></p>
<div id="def-RR" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.6 (Relative risk ratios)</strong></span> The ratio of two probabilities <span class="math inline">\(\pi_1\)</span> and <span class="math inline">\(\pi_2\)</span>,</p>
<p><span class="math display">\[\rho(\pi_1,\pi_2) = \frac{\pi_1}{\pi_2}\]</span></p>
<p>is called the:</p>
<ul>
<li>
<strong>risk ratio</strong>,</li>
<li>
<strong>relative risk ratio</strong>,</li>
<li>
<strong>probability ratio</strong>,</li>
<li>or <strong>rate ratio</strong>
</li>
</ul>
<p>of <span class="math inline">\(\pi_1\)</span> compared to <span class="math inline">\(\pi_2\)</span>.</p>
</div>
</div>
<hr>
<div id="exr-RR" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.10</strong></span> &nbsp;</p>
<div class="notes">
<p>Above, we estimated that:</p>
</div>
<p><span class="math display">\[\hat{\text{p}}(MI|OC) = 0.0026\]</span></p>
<p><span class="math display">\[\hat{\text{p}}(MI|\neg OC) = 7\times 10^{-4}\]</span></p>
<p>Now, estimate the <em>relative risk</em> of MI for OC versus non-OC.</p>
</div>
<hr>
<div id="sol-exr-RR" class="proof solution">
<p><span class="proof-title"><em>Solution 3.10</em>. </span></p>
<div class="notes">
<p>The <em>relative risk</em> of MI for OC versus non-OC is:</p>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">13</span> <span class="op">/</span> <span class="fl">5000</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">7</span> <span class="op">/</span> <span class="fl">10000</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span class="math display">\[
\begin{aligned}
\hat\rho(OC, \neg OC)
&amp;=\frac{\hat{\text{p}}(MI|OC)}{\hat{\text{p}}(MI|\neg OC)}\\
&amp;= \frac{0.0026}{7\times 10^{-4}}\\
&amp;= 3.714286
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="exr-interpret-rr" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.11</strong></span> How can we interpret the preceding relative risk estimate in prose?</p>
</div>
<hr>
<div id="sol-interpret-rr" class="proof solution">
<p><span class="proof-title"><em>Solution 3.11</em>. </span></p>
<div class="notes">
<p>We might summarize this result by saying that “the estimated probability of MI among OC users was 3.714286 <u>times as high as</u>, or 2.714286 <u>times higher than</u>, the estimated probability among OC non-users.</p>
</div>
</div>
<hr></section><section id="relative-risk-differences" class="level3" data-number="3.3.3"><h3 data-number="3.3.3" class="anchored" data-anchor-id="relative-risk-differences">
<span class="header-section-number">3.3.3</span> Relative risk differences</h3>
<div id="def-RRD" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.7 (Relative risk difference)</strong></span> &nbsp;</p>
<div class="notes">
<p>Sometimes, we divide the risk difference by the comparison probability; the result is called the <strong>relative risk difference</strong>:</p>
</div>
<p><span class="math display">\[\xi(\pi_1,\pi_2) \stackrel{\text{def}}{=}\frac{\delta(\pi_1,\pi_2)}{\pi_2}\]</span></p>
</div>
<hr>
<div id="thm-rrd-vs-rr" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.1 (Relative risk difference equals risk ratio minus 1)</strong></span> <span class="math display">\[\xi(\pi_1,\pi_2) = \rho(\pi_1,\pi_2) - 1\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[
\begin{aligned}
\xi(\pi_1,\pi_2)
&amp;\stackrel{\text{def}}{=}\frac{\delta(\pi_1,\pi_2)}{\pi_2}
\\&amp;= \frac{\pi_1-\pi_2}{\pi_2}
\\&amp;= \frac{\pi_1}{\pi_2} - 1
\\&amp;= \rho(\pi_1,\pi_2) - 1
\end{aligned}
\]</span></p>
</div>
<hr></section><section id="changing-reference-groups-in-risk-comparisons" class="level3" data-number="3.3.4"><h3 data-number="3.3.4" class="anchored" data-anchor-id="changing-reference-groups-in-risk-comparisons">
<span class="header-section-number">3.3.4</span> Changing reference groups in risk comparisons</h3>
<div class="notes">
<p>Risk differences, risk ratios, and relative risk differences are defined by two probabilities, plus a choice of which probability is the <strong>baseline</strong> or <strong>reference</strong> probability (i.e., which probability is the subtrahend of the risk difference or the denominator of the risk ratio).</p>
</div>
<p><span class="math display">\[\delta(\pi_2,\pi_1) = -\delta(\pi_1, \pi_2)\]</span></p>
<p><span class="math display">\[\rho(\pi_2,\pi_1) = \left(\rho(\pi_1,\pi_2)\right)^{-1}\]</span> <span class="math display">\[\xi(\pi_2,\pi_1) = \left(\xi(\pi_1,\pi_2) + 1\right)^{-1} - 1\]</span></p>
<div id="exr-change-ref-group" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.12</strong></span> Prove the relationships above.</p>
</div>
<hr>
<div id="exm-ref" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.3 (Switching the reference group in a risk ratio)</strong></span> Above, we estimated that the risk ratio of OC versus non-OC is:</p>
<p><span class="math display">\[
\begin{aligned}
\rho(OC, \neg OC)
&amp;= 3.714286
\end{aligned}
\]</span></p>
<p>In comparison, the risk ratio for non-OC versus OC is:</p>
<p><span class="math display">\[
\begin{aligned}
\rho(\neg OC, OC)
&amp;=\frac{\hat{\text{p}}(MI|\neg OC)}{\hat{\text{p}}(MI|OC)}\\
&amp;= \frac{7\times 10^{-4}}{0.0026}\\
&amp;= 0.269231\\
&amp;= \frac{1}{\rho(OC, \neg OC)}
\end{aligned}
\]</span></p>
</div>
</section></section><section id="odds-and-odds-ratios" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="odds-and-odds-ratios">
<span class="header-section-number">3.4</span> Odds and odds ratios</h2>
<section id="odds-and-probabilities" class="level3" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="odds-and-probabilities">
<span class="header-section-number">3.4.1</span> Odds and probabilities</h3>
<!-- https://www.overleaf.com/learn/latex/Using_colors_in_LaTeX#Named_colors_provided_by_the_xcolor_package -->
<!-- \def\or{\theta}  -->
<!-- doesn't work for some reason -->
<div class="notes">
<p>In logistic regression, we will make use of a mathematically-convenient transformation of probability, called <em>odds</em>.</p>
</div>
<hr>
<div id="def-odds" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.8 (Odds)</strong></span> The <strong>odds</strong> of an outcome <span class="math inline">\(A\)</span>, which we will represent using <span class="math inline">\(\omega\)</span> (“omega”), is the probability that the outcome occurs, divided by the probability that it doesn’t occur:</p>
<p><span id="eq-def-odds"><span class="math display">\[\omega\stackrel{\text{def}}{=}\frac{\Pr(A)}{\Pr(\neg A)} \tag{3.1}\]</span></span></p>
</div>
<hr>
<div id="thm-prob-to-odds" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.2</strong></span> If <span class="math inline">\(\pi\)</span> is the probability of an event <span class="math inline">\(A\)</span> and <span class="math inline">\(\omega\)</span> is the corresponding odds of <span class="math inline">\(A\)</span>, then:</p>
<p><span id="eq-odds-prob"><span class="math display">\[\omega= \frac{\pi}{1-\pi} \tag{3.2}\]</span></span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Using <a href="#def-odds" class="quarto-xref">Definition&nbsp;<span>3.8</span></a> and <a href="probability.html#cor-p-neg" class="quarto-xref">Corollary&nbsp;<span>C.2</span></a>:</p>
<p><span class="math display">\[
\begin{aligned}
\omega(A) &amp;\stackrel{\text{def}}{=}\frac{\Pr(A)}{\Pr(\neg A)}
\\ &amp;= \frac{\pi}{1-\pi}
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="def-odds-fn" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.9 (Odds function)</strong></span> The <strong>odds function</strong> is defined as: <span id="eq-def-odds-fn"><span class="math display">\[\text{odds}\left\{\pi\right\} \stackrel{\text{def}}{=}\frac{\pi}{1-\pi} \tag{3.3}\]</span></span></p>
</div>
<hr>
<div id="cor-oddsf-to-odds" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.1</strong></span> If <span class="math inline">\(\pi\)</span> is the probability of an outcome <span class="math inline">\(A\)</span> and <span class="math inline">\(\omega\)</span> is the corresponding odds of <span class="math inline">\(A\)</span>, then:</p>
<p><span class="math display">\[\omega= \text{odds}\left\{\pi\right\}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>By <a href="#thm-prob-to-odds" class="quarto-xref">Theorem&nbsp;<span>3.2</span></a> and <a href="#def-odds-fn" class="quarto-xref">Definition&nbsp;<span>3.9</span></a>.</p>
</div>
<hr>
<div class="notes">
<p>Thus, the odds function transforms probabilities into odds. <a href="#fig-odds-probs" class="quarto-xref">Figure&nbsp;<span>3.1</span></a> graphs the shape of this function.</p>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">odds</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pi</span><span class="op">)</span> <span class="va">pi</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pi</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">odds</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>ends <span class="op">=</span> <span class="st">"last"</span><span class="op">)</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"odds function"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.99</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Odds"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    intercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    slope <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"y=x"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-odds-probs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-odds-probs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Odds versus probability
</figcaption><div aria-describedby="fig-odds-probs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="logistic-regression_files/figure-html/fig-odds-probs-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<hr>
<div id="exm-odds" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.4 (Computing odds from probabilities)</strong></span> In <a href="#exr-probs" class="quarto-xref">Exercise&nbsp;<span>3.5</span></a>, we estimated that the probability of MI, given OC use, is <span class="math inline">\(\pi(OC) \stackrel{\text{def}}{=}\Pr(MI|OC) = 0.0026\)</span>. If this estimate is correct, then the odds of MI, given OC use, is:</p>
<p><span class="math display">\[
\begin{aligned}
\omega(OC)
&amp;\stackrel{\text{def}}{=}\frac{\Pr(MI|OC)}{\Pr(\neg MI|OC)}\\
&amp;=\frac{\Pr(MI|OC)}{1-\Pr(MI|OC)}\\
&amp;=\frac{\pi(OC)}{1-\pi(OC)}\\
&amp;=\frac{0.0026}{1-0.0026}\\
&amp;\approx 0.002607
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="exr-odds" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.13 (Computing odds from probabilities)</strong></span> Estimate the odds of MI, for non-OC users.</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[
\omega(\neg OC) = 7.004903\times 10^{-4}
\]</span></p>
</div>
</div>
<hr>
<div id="thm-est-odds" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.3 (One-sample MLE for odds)</strong></span> Let <span class="math inline">\(X_1,...X_n\)</span> be a set of <span class="math inline">\(n\)</span> <span class="math inline">\(\text{iid}\)</span> Bernoulli trials, and let <span class="math inline">\(X = \sum_{i=1}^nX_i\)</span> be their sum.</p>
<p>Then the maximum likelihood estimate of the odds of <span class="math inline">\(X=1\)</span>, <span class="math inline">\(\omega\)</span>, is:</p>
<p><span class="math display">\[
\hat{\omega}= \frac{x}{n-x}
\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[
\begin{aligned}
1-\hat\pi
&amp;= 1-\frac{x}{n}\\
&amp;= \frac{n}{n} - \frac{x}{n}\\
&amp;= \frac{n - x}{n}
\end{aligned}
\]</span></p>
<p>Thus, the estimated odds is:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\hat\pi}{1-\hat\pi}
&amp;= \frac{\left(\frac{x}{n}\right)}{\left(\frac{n-x}{n}\right)}\\
&amp;= \frac{x}{n-x}
\end{aligned}
\]</span></p>
<div class="notes">
<p>That is, odds can be calculated directly as “# events” divided by “# nonevents” (without needing to calculate <span class="math inline">\(\hat\pi\)</span> and <span class="math inline">\(1-\hat\pi\)</span> first).</p>
</div>
</div>
<hr>
<div id="exm-odds-shortcut" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.5 (Calculating odds using the shortcut)</strong></span> In <a href="#exm-odds" class="quarto-xref">Example&nbsp;<span>3.4</span></a>, we calculated <span class="math display">\[
\begin{aligned}
\omega(OC)
&amp;=0.002607
\end{aligned}
\]</span></p>
<p>Let’s recalculate this result using our shortcut.</p>
</div>
<hr>
<div id="sol-odds-shortcut" class="proof solution">
<p><span class="proof-title"><em>Solution 3.12</em>. </span><span class="math display">\[
\begin{aligned}
\omega(OC)
&amp;=\frac{13}{5000-13}\\
&amp;=0.002607
\end{aligned}
\]</span></p>
<p>Same answer as in <a href="#exm-odds" class="quarto-xref">Example&nbsp;<span>3.4</span></a>!</p>
</div>
<hr>
<div id="thm-odds-simplified" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.4 (Simplified expressions for odds function)</strong></span> &nbsp;</p>
<div class="notes">
<p>Two equivalent expressions for the odds function are:</p>
</div>
<p><span id="eq-odds-reduced"><span class="math display">\[
\begin{aligned}
\text{odds}\left\{\pi\right\} &amp;= \frac{1}{\pi^{-1}-1}
\\ &amp;= \left(\pi^{-1}-1\right)^{-1}
\end{aligned}
\tag{3.4}\]</span></span></p>
</div>
<hr>
<div id="exr-odds2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.14</strong></span> Prove <a href="#thm-odds-simplified" class="quarto-xref">Theorem&nbsp;<span>3.4</span></a>.</p>
</div>
<hr>
<div id="sol-odds2" class="proof solution">
<p><span class="proof-title"><em>Solution 3.13</em>. </span>Starting from <a href="#def-odds-fn" class="quarto-xref">Definition&nbsp;<span>3.9</span></a>:</p>
<p><span class="math display">\[
\begin{aligned}
\text{odds}\left\{\pi\right\} &amp;= \frac{\pi}{1-\pi}
\\
&amp;= \frac{\pi}{1-\pi}\frac{\pi^{-1}}{\pi^{-1}}
\\
&amp;= \frac{\pi\pi^{-1}}{(1-\pi)\pi^{-1}}
\\
&amp;= \frac{1}{(\pi^{-1}-\pi\pi^{-1})}
\\
&amp;= \frac{1}{(\pi^{-1}-1)}
\\
&amp;= \left(\pi^{-1}-1\right)^{-1}
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="thm-deriv-odds" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.5 (Derivative of odds function)</strong></span> <span class="math display">\[{\text{odds}}'\left\{\pi\right\} = \frac{1}{\left(1-\pi\right)^2}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[
\begin{aligned}
{\text{odds}}'\left\{\pi\right\}
   &amp;= \frac{\partial}{\partial \pi}\left(\frac{\pi}{1-\pi}\right)
\\ &amp;=  \frac {\frac{\partial}{\partial \pi}\pi} {1-\pi} -
       \left(\frac{\pi}{\left(1-\pi\right)^2} \cdot\frac{\partial}{\partial \pi}\left(1-\pi\right)\right)
\\ &amp;=  \frac{1}{1-\pi} - \frac{\pi}{\left(1-\pi\right)^2} \cdot(-1)
\\ &amp;=  \frac{1}{1-\pi} + \frac{\pi}{\left(1-\pi\right)^2}
\\ &amp;=  \frac{1-\pi}{\left(1-\pi\right)^2} + \frac{\pi}{\left(1-\pi\right)^2}
\\ &amp;=  \frac{1-\pi + \pi}{\left(1-\pi\right)^2}
\\ &amp;=  \frac{1}{\left(1-\pi\right)^2}
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="cor-d_odds-d_prob" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.2</strong></span> <span class="math display">\[\frac{\partial \omega}{\partial \pi} = \frac{1}{\left(1-\pi\right)^2}\]</span></p>
</div>
<hr>
<section id="odds-of-rare-events" class="level4"><h4 class="anchored" data-anchor-id="odds-of-rare-events">Odds of rare events</h4>
<p>For rare events (small <span class="math inline">\(\pi\)</span>), odds and probabilities are nearly equal, because <span class="math inline">\(1-\pi \approx 1\)</span> (see <a href="#fig-odds-probs" class="quarto-xref">Figure&nbsp;<span>3.1</span></a>).</p>
<p>For example, in <a href="#exm-odds" class="quarto-xref">Example&nbsp;<span>3.4</span></a>, the probability and odds differ by <span class="math inline">\(6.777622\times 10^{-6}\)</span>.</p>
<hr>
<div id="exr-odds-probs" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.15</strong></span> What odds value corresponds to the probability <span class="math inline">\(\pi = 0.2\)</span>, and what is the numerical difference between these two values?</p>
</div>
<hr>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[
\omega= \frac{\pi}{1-\pi}
=\frac{.2}{.8}
= .25
\]</span></p>
</div>
<hr>
<div id="thm-odds-minus-probs" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.6</strong></span> Let <span class="math inline">\(\omega= \frac{\pi}{1-\pi}\)</span>. Then:</p>
<p><span class="math display">\[\omega- \pi =  \omega\cdot\pi\]</span></p>
</div>
<hr>
<div id="exr-odds-minus-probs" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.16</strong></span> Prove <a href="#thm-odds-minus-probs" class="quarto-xref">Theorem&nbsp;<span>3.6</span></a>.</p>
</div>
<hr>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[
\begin{aligned}
\omega- \pi
&amp;= \frac{\pi}{1-\pi} - \pi
\\ &amp;= \frac{\pi}{1-\pi} - \frac{\pi(1-\pi)}{1-\pi}
\\ &amp;= \frac{\pi}{1-\pi} - \frac{\pi - \pi^2}{1-\pi}
\\ &amp;= \frac{\pi - (\pi - \pi^2)}{1-\pi}
\\ &amp;= \frac{\pi - \pi + \pi^2}{1-\pi}
\\ &amp;= \frac{\pi^2}{1-\pi}
\\ &amp;= \frac{\pi}{1-\pi} \pi
\\ &amp;= \omega\pi
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="lem-odds-neg" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3.1 (Odds of a non-event)</strong></span> If <span class="math inline">\(\pi\)</span> is the odds of event <span class="math inline">\(A\)</span> and <span class="math inline">\(\omega\)</span> is the corresponding odds of <span class="math inline">\(A\)</span>, then the odds of <span class="math inline">\(\neg A\)</span> are:</p>
<p><span class="math display">\[
\begin{aligned}
\omega(\neg A) &amp;= \frac{1-\pi}{\pi}
\\&amp;= \pi^{-1}-1
\end{aligned}
\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Left to the reader.</p>
</div>
<hr></section></section><section id="the-inverse-odds-function" class="level3" data-number="3.4.2"><h3 data-number="3.4.2" class="anchored" data-anchor-id="the-inverse-odds-function">
<span class="header-section-number">3.4.2</span> The inverse odds function</h3>
<!-- https://www.overleaf.com/learn/latex/Using_colors_in_LaTeX#Named_colors_provided_by_the_xcolor_package -->
<!-- \def\or{\theta}  -->
<!-- doesn't work for some reason -->
<div id="exr-odds-to-prob" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.17</strong></span> If <span class="math inline">\(\pi\)</span> is the probability of an event <span class="math inline">\(A\)</span> and <span class="math inline">\(\omega\)</span> is the corresponding odds of <span class="math inline">\(A\)</span>, how can we compute <span class="math inline">\(\pi\)</span> from <span class="math inline">\(\omega\)</span>?</p>
<p>For example, if <span class="math inline">\(\omega= 3/2\)</span>, what is <span class="math inline">\(\pi\)</span>?</p>
</div>
<hr>
<div id="sol-odds-to-prob" class="proof solution">
<p><span class="proof-title"><em>Solution 3.14</em>. </span>Starting from <a href="#thm-prob-to-odds" class="quarto-xref">Theorem&nbsp;<span>3.2</span></a>, we can solve <a href="#eq-odds-prob" class="quarto-xref">Equation&nbsp;<span>3.2</span></a> for <span class="math inline">\(\pi\)</span> in terms of <span class="math inline">\(\omega\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\omega&amp;= \frac{\pi}{1-\pi}
\\
(1-\pi) \omega&amp;= \pi
\\
\omega-\pi\omega&amp;= \pi
\\
\omega&amp;= \pi + \pi\omega
\\
\omega&amp;= (1 + \omega)\pi
\\
\pi &amp;= \frac{\omega}{1 + \omega}
\end{aligned}
\]</span> So if <span class="math inline">\(\omega= 3/2\)</span>,</p>
<p><span class="math display">\[
\begin{aligned}
\pi
&amp;= \frac{3/2}{1 + 3/2}
\\
&amp;= \frac{3/2}{5/2}
\\
&amp;= \frac{3}{5}
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="thm-odds-to-prob" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.7</strong></span> If <span class="math inline">\(\pi\)</span> is the probability of an event and <span class="math inline">\(\omega\)</span> is the corresponding odds of that event, then:</p>
<p><span id="eq-prob-from-odds"><span class="math display">\[\pi = \frac{\omega}{1+\omega} \tag{3.5}\]</span></span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>By <a href="#thm-prob-to-odds" class="quarto-xref">Theorem&nbsp;<span>3.2</span></a> and <a href="#sol-odds-to-prob" class="quarto-xref">Solution&nbsp;<span>3.14</span></a>.</p>
</div>
<hr>
<div id="def-inv-odds" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.10 (inverse odds function)</strong></span> <span id="eq-invodds-fn"><span class="math display">\[
\text{invodds}\left\{\omega\right\} \stackrel{\text{def}}{=}\frac{\omega}{1 + \omega}
\tag{3.6}\]</span></span></p>
<p>can be called the <strong>inverse-odds function</strong>.</p>
</div>
<hr>
<div id="cor-invodds-pi" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.3</strong></span> <span class="math display">\[\pi= \text{invodds}\left\{\omega\right\}\]</span></p>
</div>
<hr>
<div id="cor-invodds-odds-inv" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.4</strong></span> <span class="math display">\[\text{invodds}\left\{\omega\right\} = \text{odds}^{-1}\left\{\omega\right\}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span></p>
<div id="lem-one-plus-odds" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3.2</strong></span> <span class="math display">\[
\begin{aligned}
1 + \text{odds}\left\{\pi\right\}
&amp;= 1 + \frac{\pi}{1 - \pi}
\\
&amp;= \frac{(1 - \pi) + \pi}{1 - \pi}
\\
&amp;= \frac{1}{1 - \pi}
\\
&amp;= {1/(1 - \pi)}
\end{aligned}
\]</span></p>
</div>
<hr>
<p><span class="math display">\[
\begin{aligned}
\text{invodds}\left\{\text{odds}\left\{\pi\right\}\right\}
&amp;= \frac
{\text{odds}\left\{\pi\right\}}
{1 + \text{odds}\left\{\pi\right\}}
\\
&amp;= \frac
{\pi/(1 - \pi)}
{1/(1 - \pi)}
\\
&amp;= \pi
\end{aligned}
\]</span></p>
<p>Likewise (not shown):</p>
<p><span class="math display">\[\text{odds}\left\{\text{invodds}\left\{\omega\right\}\right\} = \omega\]</span></p>
</div>
<hr>
<div class="notes">
<p>The inverse-odds function converts odds into their corresponding probabilities (<a href="#fig-inv-odds" class="quarto-xref">Figure&nbsp;<span>3.2</span></a>). Its domain of inputs is <span class="math inline">\(\omega \in [0,\infty)\)</span> and its range of outputs is <span class="math inline">\(\pi \in [0,1]\)</span>.</p>
<p>I haven’t seen anyone give the inverse-odds function a concise name; maybe <span class="math inline">\(\text{prob}()\)</span> or <span class="math inline">\(\text{probs}()\)</span> or <span class="math inline">\(\text{risk}()\)</span>?</p>
</div>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">odds_inv</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">omega</span><span class="op">)</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">omega</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">odds_inv</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"inverse-odds"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Odds"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"x=y"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-inv-odds" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-inv-odds-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: The inverse odds function, <span class="math inline">\(\text{invodds}\left\{\omega\right\}\)</span>
</figcaption><div aria-describedby="fig-inv-odds-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="logistic-regression_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<hr>
<div id="exr-odds-probs" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.18</strong></span> What probability corresponds to an odds of <span class="math inline">\(\omega= 1\)</span>, and what is the numerical difference between these two values?</p>
</div>
<hr>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span><span class="math display">\[
\pi(1) = \frac{1}{1+1}
=\frac{1}{2}
= .5
\]</span> <span class="math display">\[
1 - \pi(1) = 1 - .5 = .5
\]</span></p>
</div>
<hr>
<div id="lem-invodds-simplified" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3.3 (Simplified expression for inverse odds function)</strong></span> &nbsp;</p>
<div class="notes">
<p>Equivalent expressions for the inverse odds function are:</p>
</div>
<p><span id="eq-inv-odds-reduced"><span class="math display">\[
\begin{aligned}
\pi(\omega)
&amp;= \frac{1}{1+\omega^{-1}}
\\
&amp;= (1+\omega^{-1})^{-1}
\end{aligned}
\tag{3.7}\]</span></span></p>
</div>
<hr>
<div id="exr-inv-odds2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.19</strong></span> Prove that <a href="#eq-inv-odds-reduced" class="quarto-xref">Equation&nbsp;<span>3.7</span></a> is equivalent to <a href="#def-inv-odds" class="quarto-xref">Definition&nbsp;<span>3.10</span></a>.</p>
</div>
<hr>
<div id="sol-inv-odds2" class="proof solution">
<p><span class="proof-title"><em>Solution 3.15</em>. </span>Analogous to <a href="#sol-odds2" class="quarto-xref">Solution&nbsp;<span>3.13</span></a>.</p>
</div>
<hr>
<div id="lem-one-minus-odds-inv" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3.4 (One minus inverse-odds)</strong></span> <span class="math display">\[1 - \text{invodds}\left\{\omega\right\} = \frac{1}{1+\omega}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[
\begin{aligned}
1 - \text{invodds}\left\{\omega\right\} &amp;= 1 - \frac{\omega}{1 + \omega}
\\ &amp;= \frac{{\color{red}1+\omega}}{1 + \omega} - \frac{{\color{blue}\omega}}{1 + \omega}
\\ &amp;= \frac{{\color{red}(1+\omega)} - {\color{blue}\omega}}{1 + \omega}
\\ &amp;= \frac{1 + \omega- \omega}{1 + \omega}
\\ &amp;= \frac{1}{1 + \omega}
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="lem-inverse-odds-nonevent" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3.5</strong></span> If <span class="math inline">\(\omega\)</span> is the odds of event <span class="math inline">\(A\)</span>, then the probability that <span class="math inline">\(A\)</span> does not occur is:</p>
<p><span class="math display">\[\Pr(\neg A) = \frac{1}{1+\omega}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span></p>
<div class="notes">
<p>Use <a href="probability.html#cor-p-neg0" class="quarto-xref">Corollary&nbsp;<span>C.1</span></a> and <a href="#lem-one-minus-odds-inv" class="quarto-xref">Lemma&nbsp;<span>3.4</span></a>:</p>
</div>
<p><span class="math display">\[
\begin{aligned}
\Pr(\neg A)
&amp;= 1 - \Pr(A)
\\ &amp;= 1 - \text{invodds}\left\{\omega\right\}
\\ &amp;= \frac{1}{1 + \omega}
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="cor-inverse-odds-nonevent" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.5</strong></span> If <span class="math inline">\(\pi\)</span> is the probability of event <span class="math inline">\(A\)</span> and <span class="math inline">\(\omega\)</span> is the corresponding odds of event <span class="math inline">\(A\)</span>, then:</p>
<p><span class="math display">\[1-\pi= \frac{1}{1+\omega}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Combine <a href="#lem-inverse-odds-nonevent" class="quarto-xref">Lemma&nbsp;<span>3.5</span></a> and <a href="probability.html#cor-p-neg" class="quarto-xref">Corollary&nbsp;<span>C.2</span></a>.</p>
</div>
<hr>
<div id="cor-inverse-odds-nonevent" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.6</strong></span> <span class="math display">\[1+\omega= \frac{1}{1-\pi}\]</span></p>
</div>
<div class="notes">
<p>This result is essentially the same as <a href="#lem-one-plus-odds" class="quarto-xref">Lemma&nbsp;<span>3.2</span></a>.</p>
</div>
<hr>
<div id="lem-deriv-invodds" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3.6 (Derivative of inverse odds function)</strong></span> <span class="math display">\[{\text{odds}^{-1}}'\left\{\omega\right\} = \frac{1}{\left(1+\omega\right)^2}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span></p>
<div class="notes">
<p>Use the quotient rule:</p>
</div>
<p><span class="math display">\[
\begin{aligned}
{\text{odds}^{-1}}'(\omega)
&amp;= \frac{\partial}{\partial \omega} \text{invodds}\left\{\omega\right\}
\\ &amp;= \frac{\partial}{\partial \omega} \frac{\omega}{1+\omega}
\\ &amp;= \frac{\frac{\partial}{\partial \omega}\omega}{1+\omega} - \frac{\omega}{\left(1+\omega\right)^2} \cdot\frac{\partial}{\partial \omega}(1+\omega)
\\ &amp;= \frac{1}{1+\omega} - \frac{\omega}{\left(1+\omega\right)^2} \cdot 1
\\ &amp;= \frac{1}{1+\omega} - \frac{\omega}{\left(1+\omega\right)^2}
\\ &amp;= \frac{1+\omega}{\left(1+\omega\right)^2} - \frac{\omega}{\left(1+\omega\right)^2}
\\ &amp;= \frac{1+\omega- \omega}{\left(1+\omega\right)^2}
\\ &amp;= \frac{1}{\left(1+\omega\right)^2}
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="cor-deriv-invodds" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.7</strong></span> <span class="math display">\[{\text{odds}^{-1}}'\left\{\omega\right\} = \left(1 - \text{invodds}\left\{\omega\right\}\right)^2\]</span></p>
</div>
<hr>
<div id="cor-deriv-invodds-pi-scale" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.8</strong></span> <span class="math display">\[{\text{odds}^{-1}}'\left\{\omega\right\} = (1-\pi)^2\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Combining <a href="#cor-inverse-odds-nonevent" class="quarto-xref">Corollary&nbsp;<span>3.6</span></a> and <a href="#lem-deriv-invodds" class="quarto-xref">Lemma&nbsp;<span>3.6</span></a>:</p>
<p><span class="math display">\[
\begin{aligned}
{\text{odds}^{-1}}'\left\{\omega\right\} &amp;= \left(\frac{1}{1+\omega}\right)^2
\\
&amp;= (1-\pi)^2
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="cor-d_prob-d_odds" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.9</strong></span> <span id="eq-d_prob-d_odds"><span class="math display">\[\frac{\partial \pi}{\partial \omega} = (1-\pi)^2 \tag{3.8}\]</span></span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>By <a href="#cor-deriv-invodds-pi-scale" class="quarto-xref">Corollary&nbsp;<span>3.8</span></a>:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial \pi}{\partial \omega} &amp;= \frac{\partial}{\partial \omega} \text{odds}^{-1}(\omega)
\\
&amp;= (1-\pi)^2
\end{aligned}
\]</span></p>
<p>Alternatively, by <a href="#cor-d_odds-d_prob" class="quarto-xref">Corollary&nbsp;<span>3.2</span></a>:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial \pi}{\partial \omega}
&amp;= \left(\frac{\partial \omega}{\partial \pi}\right)^{-1}
\\
&amp;= \left(\frac{1}{\left(1-\pi\right)^2}\right)^{-1}
\\
&amp;= \left(1-\pi\right)^2
\end{aligned}
\]</span></p>
</div>
</section><section id="odds-ratios" class="level3" data-number="3.4.3"><h3 data-number="3.4.3" class="anchored" data-anchor-id="odds-ratios">
<span class="header-section-number">3.4.3</span> Odds ratios</h3>
<div class="notes">
<p>Now that we have defined odds, we can introduce another way of comparing event probabilities: odds ratios.</p>
</div>
<div id="def-OR" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.11 (Odds ratio)</strong></span> The <strong>odds ratio</strong> for two odds <span class="math inline">\(\omega_1\)</span>, <span class="math inline">\(\omega_2\)</span> is their ratio:</p>
<p><span class="math display">\[\theta(\omega_1, \omega_2) = \frac{\omega_1}{\omega_2}\]</span></p>
</div>
<hr>
<div id="exm-OR" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.6 (Calculating odds ratios)</strong></span> In <a href="#exm-oc-mi" class="quarto-xref">Example&nbsp;<span>3.1</span></a>, the odds ratio for OC users versus OC-non-users is:</p>
<p><span class="math display">\[
\begin{aligned}
\theta(\omega(OC), \omega(\neg OC))
&amp;= \frac{\omega(OC)}{\omega(\neg OC)}\\
&amp;= \frac{0.0026}{7\times 10^{-4}}\\
&amp;= 3.714286\\
\end{aligned}
\]</span></p>
</div>
<hr>
<section id="a-shortcut-for-calculating-odds-ratio-estimates" class="level4 smaller"><h4 class="smaller anchored" data-anchor-id="a-shortcut-for-calculating-odds-ratio-estimates">A shortcut for calculating odds ratio estimates</h4>
<div class="notes">
<p>The general form of a two-by-two table is shown in <a href="#tbl-2x2-generic" class="quarto-xref">Table&nbsp;<span>3.2</span></a>.</p>
<div id="tbl-2x2-generic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2x2-generic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.2: A generic 2x2 table
</figcaption><div aria-describedby="tbl-2x2-generic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead><tr class="header">
<th></th>
<th>Event</th>
<th>Non-Event</th>
<th>Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Exposed</td>
<td>a</td>
<td>b</td>
<td>a+b</td>
</tr>
<tr class="even">
<td>Non-exposed</td>
<td>c</td>
<td>d</td>
<td>c+d</td>
</tr>
<tr class="odd">
<td>Total</td>
<td>a+c</td>
<td>b+d</td>
<td>a+b+c+d</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div class="notes">
<p>From this table, we have:</p>
</div>
<ul>
<li><p><span class="math inline">\(\hat\pi(Event|Exposed) = a/(a+b)\)</span></p></li>
<li><p><span class="math inline">\(\hat\pi(\neg Event|Exposed) = b/(a+b)\)</span></p></li>
<li><p><span class="math inline">\(\hat\omega(Event|Exposed) = \frac{\frac{a}{a+b}}{\frac{b}{a+b}}=\frac{a}{b}\)</span></p></li>
<li><p><span class="math inline">\(\hat\omega(Event|\neg Exposed) = \frac{c}{d}\)</span> (see <a href="#exr-odds-generic" class="quarto-xref">Exercise&nbsp;<span>3.20</span></a>)</p></li>
<li><p><span class="math inline">\(\theta(Exposed,\neg Exposed) = \frac{\frac{a}{b}}{\frac{c}{d}} = \frac{ad}{bc}\)</span></p></li>
</ul>
<hr>
<div id="exr-odds-generic" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.20</strong></span> Given <a href="#tbl-2x2-generic" class="quarto-xref">Table&nbsp;<span>3.2</span></a>, show that <span class="math inline">\(\hat\omega(Event|\neg Exposed) = \frac{c}{d}\)</span>.</p>
</div>
<hr></section><section id="sec-OR-props" class="level4"><h4 class="anchored" data-anchor-id="sec-OR-props">Properties of odds ratios</h4>
<div class="notes">
<p>Odds ratios have a special property: we can swap a covariate with the outcome, and the odds ratio remains the same.</p>
</div>
<div id="thm-or-swap" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.8 (Odds ratios are reversible)</strong></span> For any two events <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>:</p>
<p><span class="math display">\[\theta(A|B) = \theta(B|A)\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[
\begin{aligned}
\theta(A|B) &amp;\stackrel{\text{def}}{=}\frac{\omega(A|B)}{\omega(A|\neg B)}
\\ &amp;= \frac
{\left(\frac{\text{p}(A|B)}{\text{p}(\neg A|B)}\right)}
{\left(\frac{\text{p}(A|\neg B)}{\text{p}(\neg A| \neg B)}\right)}
\\ &amp;=
\left(\frac{\text{p}(A|B)}{\text{p}(\neg A|B)}\right)
\left(\frac{\text{p}(A|\neg B)}{\text{p}(\neg A| \neg B)}\right)^{-1}
\\ &amp;=
\left(\frac{\text{p}(A|B)}{\text{p}(\neg A|B)}\right)
\left(\frac{\text{p}(\neg A| \neg B)}{\text{p}(A|\neg B)}\right)
\\ &amp;=
\left(\frac{\text{p}(A|B)}{\text{p}(\neg A|B)} \cdot \frac{\text{p}(B)}{\text{p}(B)}\right)
\left(\frac{\text{p}(\neg A| \neg B)}{\text{p}(A|\neg B)} \cdot \frac{\text{p}(\neg B)}{\text{p}(\neg B)}\right)
\\ &amp;=
\left(\frac{\text{p}(A,B)}{\text{p}(\neg A,B)}\right)
\left(\frac{\text{p}(\neg A, \neg B)}{\text{p}(A, \neg B)}\right)
\\ &amp;=
\left(\frac{\text{p}(B,A)}{{\color{red}\text{p}(B,\neg A)}}\right)
\left(\frac{\text{p}(\neg B, \neg A)}{{\color{blue}\text{p}(\neg B, A)}}\right)
\\ &amp;=
\left(\frac{\text{p}(B,A)}{{\color{blue}\text{p}(\neg B, A)}}\right)
\left(\frac{\text{p}(\neg B, \neg A)}{{\color{red}\text{p}(B,\neg A)}}\right)
\\ &amp;= \text{[reverse the preceding steps]}
\\ &amp;= \theta(B|A)
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="exm-or-inv-MI" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.7</strong></span> In <a href="#exm-oc-mi" class="quarto-xref">Example&nbsp;<span>3.1</span></a>, we have:</p>
<p><span class="math display">\[
\begin{aligned}
\theta(MI; OC)
&amp;\stackrel{\text{def}}{=}
\frac{\omega(MI|OC)}{\omega(MI|\neg OC)}\\
&amp;\stackrel{\text{def}}{=}\frac
{\left(\frac{\Pr(MI|OC)}{\Pr(\neg MI|OC)}\right)}
{\left(\frac{\Pr(MI|\neg OC)}{\Pr(\neg MI|\neg OC)}\right)}\\
&amp;= \frac
{\left(\frac{\Pr(MI,OC)}{\Pr(\neg MI,OC)}\right)}
{\left(\frac{\Pr(MI,\neg OC)}{\Pr(\neg MI,\neg OC)}\right)}\\
&amp;= \left(\frac{\Pr(MI,OC)}{\Pr(\neg MI,OC)}\right)
\left(\frac{\Pr(\neg MI,\neg OC)}{\Pr(MI,\neg OC)}\right)\\
&amp;= \left(\frac{\Pr(MI,OC)}{\Pr(MI,\neg OC)}\right)
\left(\frac{\Pr(\neg MI,\neg OC)}{\Pr(\neg MI,OC)}\right)\\
&amp;= \left(\frac{\Pr(OC,MI)}{\Pr(\neg OC,MI)}\right)
\left(\frac{\Pr(\neg OC,\neg MI)}{\Pr(OC,\neg MI)}\right)\\
&amp;= \left(\frac{\Pr(OC|MI)}{\Pr(\neg OC|MI)}\right)
\left(\frac{\Pr(\neg OC|\neg MI)}{\Pr(OC|\neg MI)}\right)\\
&amp;= \frac{\left(\frac{\Pr(OC|MI)}{\Pr(\neg OC|MI)}\right)}
{\left(\frac{\Pr(OC|\neg MI)}{\Pr(\neg OC|\neg MI)}\right)}\\
&amp;\stackrel{\text{def}}{=}\frac{\omega(OC|MI)}
{\omega(OC|\neg MI)}\\
&amp;\stackrel{\text{def}}{=}\theta(OC; MI)
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="exr-2x2-generic" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.21</strong></span> For <a href="#tbl-2x2-generic" class="quarto-xref">Table&nbsp;<span>3.2</span></a>, show that <span class="math inline">\(\hat\theta(Exposed, Unexposed) = \hat\theta(Event, \neg Event)\)</span>.</p>
</div>
<hr>
<div class="notes">
<p>Conditional odds ratios have the same reversibility property:</p>
</div>
<div id="thm-conditional-OR-swap" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.9 (Conditional odds ratios are reversible)</strong></span> For any three events <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>:</p>
<p><span class="math display">\[\theta(A|B,C) = \theta(B|A,C)\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Apply the same steps as for <a href="#thm-or-swap" class="quarto-xref">Theorem&nbsp;<span>3.8</span></a>, inserting <span class="math inline">\(C\)</span> into the conditions (RHS of <span class="math inline">\(|\)</span>) of every expression.</p>
</div>
<hr></section><section id="sec-OR-RR" class="level4"><h4 class="anchored" data-anchor-id="sec-OR-RR">Odds Ratios vs Probability (Risk) Ratios</h4>
<div class="notes">
<p>When the outcome is rare (i.e., its probability is small) for both groups being compared in an odds ratio, the odds of the outcome will be similar to the probability of the outcome, and thus the risk ratio will be similar to the odds ratio.</p>
</div>
<section id="case-1-rare-events" class="level5"><h5 class="anchored" data-anchor-id="case-1-rare-events">Case 1: rare events</h5>
<p>For rare events, odds ratios and probability (a.k.a. risk, a.k.a. prevalence) ratios will be close:</p>
<p><span class="math display">\[\pi_1 = .01\]</span> <span class="math display">\[\pi_2 = .02\]</span></p>
<div class="cell">
<details open="" class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pi1</span> <span class="op">&lt;-</span> <span class="fl">.01</span></span>
<span><span class="va">pi2</span> <span class="op">&lt;-</span> <span class="fl">.02</span></span>
<span><span class="va">pi2</span> <span class="op">/</span> <span class="va">pi1</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="fu">odds</span><span class="op">(</span><span class="va">pi2</span><span class="op">)</span> <span class="op">/</span> <span class="fu">odds</span><span class="op">(</span><span class="va">pi1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.02041</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<div id="exm-or-rr-OC-MI" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.8</strong></span> In <a href="#exm-oc-mi" class="quarto-xref">Example&nbsp;<span>3.1</span></a>, the outcome is rare for both OC and non-OC participants, so the odds for both groups are similar to the corresponding probabilities, and the odds ratio is similar the risk ratio.</p>
</div>
<hr></section><section id="case-2-frequent-events" class="level5"><h5 class="anchored" data-anchor-id="case-2-frequent-events">Case 2: frequent events</h5>
<p><span class="math display">\[\pi_1 = .4\]</span></p>
<p><span class="math display">\[\pi_2 = .5\]</span></p>
<p>For more frequently-occurring outcomes, this won’t be the case:</p>
<div class="cell">
<details open="" class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pi1</span> <span class="op">&lt;-</span> <span class="fl">.4</span></span>
<span><span class="va">pi2</span> <span class="op">&lt;-</span> <span class="fl">.5</span></span>
<span><span class="va">pi2</span> <span class="op">/</span> <span class="va">pi1</span></span>
<span><span class="co">#&gt; [1] 1.25</span></span>
<span><span class="fu">odds</span><span class="op">(</span><span class="va">pi2</span><span class="op">)</span> <span class="op">/</span> <span class="fu">odds</span><span class="op">(</span><span class="va">pi1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr></section></section><section id="odds-ratios-in-case-control-studies" class="level4"><h4 class="anchored" data-anchor-id="odds-ratios-in-case-control-studies">Odds Ratios in Case-Control Studies</h4>
<div class="notes">
<p><a href="#tbl-oc-mi" class="quarto-xref">Table&nbsp;<span>3.1</span></a> simulates a follow-up study in which two populations were followed and the number of MI’s was observed. The risks are <span class="math inline">\(P(MI|OC)\)</span> and <span class="math inline">\(P(MI|\neg OC)\)</span> and we can estimate these risks from the data.</p>
<p>But suppose we had a case-control study in which we had 100 women with MI and selected a comparison group of 100 women without MI (matched as groups on age, etc.). Then MI is not random, and we cannot compute P(MI|OC) and we cannot compute the risk ratio. However, the odds ratio however can be computed.</p>
<p>The disease odds ratio is the odds for the disease in the exposed group divided by the odds for the disease in the unexposed group, and we cannot validly compute and use these separate parts.</p>
<p>We can still validly compute and use the exposure odds ratio, which is the odds for exposure in the disease group divided by the odds for exposure in the non-diseased group (because exposure can be treated as random):</p>
</div>
<p><span class="math display">\[
\hat\theta(OC|MI) =
\frac{\hat{\omega}(OC|MI)}{\hat{\omega}(OC|\neg MI)}
\]</span></p>
<div class="notes">
<p>And these two odds ratios, <span class="math inline">\(\hat\theta(MI|OC)\)</span> and <span class="math inline">\(\hat\theta(OC|MI)\)</span>, are mathematically equivalent, as we saw in <a href="#sec-OR-props" class="quarto-xref"><span>Section 3.4.3.2</span></a>:</p>
</div>
<p><span class="math display">\[\hat\theta(MI|OC) = \hat\theta(OC|MI)\]</span></p>
<hr>
<div id="exr-or-rev" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.22</strong></span> Calculate the odds ratio of MI with respect to OC use, assuming that <a href="#tbl-oc-mi" class="quarto-xref">Table&nbsp;<span>3.1</span></a> comes from a case-control study. Confirm that the result is the same as in <a href="#exm-OR" class="quarto-xref">Example&nbsp;<span>3.6</span></a>.</p>
</div>
<hr>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tbl_oc_mi</span> <span class="op">|&gt;</span> <span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-oc-mi2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-oc-mi2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.3: Simulated data from study of oral contraceptive use and heart attack risk
</figcaption><div aria-describedby="tbl-oc-mi2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">OC</th>
<th style="text-align: center;">MI</th>
<th style="text-align: center;">No MI</th>
<th style="text-align: center;">Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">OC use</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">4,987</td>
<td style="text-align: center;">5,000</td>
</tr>
<tr class="even">
<td style="text-align: center;">No OC use</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">9,993</td>
<td style="text-align: center;">10,000</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Total</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">14,980</td>
<td style="text-align: center;">15,000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
<ul>
<li><p><span class="math inline">\(\omega(OC|MI) = P(OC|MI)/(1 – P(OC|MI) = \frac{13}{7} = 1.857143\)</span></p></li>
<li><p><span class="math inline">\(\omega(OC|\neg MI) = P(OC|\neg MI)/(1 – P(OC|\neg MI) = \frac{4987}{9993} = 0.499049\)</span></p></li>
<li><p><span class="math inline">\(\theta(OC,MI) = \frac{\omega(OC|MI)}{\omega(OC|\neg MI)} = \frac{13/7}{4987/9993} = 3.721361\)</span></p></li>
</ul>
<div class="notes">
<p>This is the same estimate we calculated in <a href="#exm-OR" class="quarto-xref">Example&nbsp;<span>3.6</span></a>.</p>
</div>
</div>
<hr></section><section id="odds-ratios-in-cross-sectional-studies" class="level4"><h4 class="anchored" data-anchor-id="odds-ratios-in-cross-sectional-studies">Odds Ratios in Cross-Sectional Studies</h4>
<ul>
<li><p>If a cross-sectional study is a probability sample of a population (which it rarely is) then we can estimate risks.</p></li>
<li><p>If it is a sample, but not an unbiased probability sample, then we need to treat it in the same way as a case-control study.</p></li>
<li><p>We can validly estimate odds ratios in either case.</p></li>
<li><p>But we can usually not validly estimate risks and risk ratios.</p></li>
</ul></section></section></section><section id="the-logit-and-expit-functions" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="the-logit-and-expit-functions">
<span class="header-section-number">3.5</span> The logit and expit functions</h2>
<section id="the-logit-function" class="level3" data-number="3.5.1"><h3 data-number="3.5.1" class="anchored" data-anchor-id="the-logit-function">
<span class="header-section-number">3.5.1</span> The logit function</h3>
<div id="def-logodds" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.12 (log-odds)</strong></span> &nbsp;</p>
<div class="notes">
<p>If <span class="math inline">\(\omega\)</span> is the odds of an event <span class="math inline">\(A\)</span>, then the <strong>log-odds</strong> of <span class="math inline">\(A\)</span>, which we will represent by <span class="math inline">\(\eta\)</span> (“eta”), is the natural logarithm of the odds of <span class="math inline">\(A\)</span>:</p>
</div>
<p><span id="eq-def-logodds"><span class="math display">\[\eta\stackrel{\text{def}}{=}\text{log}\left\{\omega\right\} \tag{3.9}\]</span></span></p>
</div>
<hr>
<div id="thm-odds-from-logodds" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.10</strong></span> &nbsp;</p>
<div class="notes">
<p>If <span class="math inline">\(\omega\)</span> is the odds of an event <span class="math inline">\(A\)</span> and <span class="math inline">\(\eta\)</span> is the corresponding log-odds of <span class="math inline">\(A\)</span>, then:</p>
</div>
<p><span class="math display">\[\omega= \text{exp}\left\{\eta\right\}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Start from <a href="#def-logodds" class="quarto-xref">Definition&nbsp;<span>3.12</span></a> and solve for <span class="math inline">\(\omega\)</span>.</p>
</div>
<hr>
<div id="thm-logodds-pi" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.11</strong></span> If <span class="math inline">\(\pi\)</span> is the probability of an event <span class="math inline">\(A\)</span>, <span class="math inline">\(\omega\)</span> is the corresponding odds of <span class="math inline">\(A\)</span>, and <span class="math inline">\(\eta\)</span> is the corresponding log-odds of <span class="math inline">\(A\)</span>, then:</p>
<p><span id="eq-logodds-from-prob"><span class="math display">\[\eta= \text{log}\left\{\frac{\pi}{1-\pi}\right\} \tag{3.10}\]</span></span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Apply <a href="#def-logodds" class="quarto-xref">Definition&nbsp;<span>3.12</span></a> and then <a href="#thm-prob-to-odds" class="quarto-xref">Theorem&nbsp;<span>3.2</span></a>.</p>
</div>
<hr>
<div id="def-logit-fn" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.13 (logit function)</strong></span> &nbsp;</p>
<div class="notes">
<p>The <strong>logit function</strong> of a probability <span class="math inline">\(\pi\)</span> is the natural logarithm of the <a href="#def-odds-fn">odds function</a> of <span class="math inline">\(\pi\)</span>:</p>
</div>
<p><span class="math display">\[\text{logit}(\pi) \stackrel{\text{def}}{=}\text{log}\left\{\text{odds}\left\{\pi\right\}\right\}\]</span></p>
<div class="notes">
<p>The <strong>logit function</strong> is a <a href="https://en.wikipedia.org/wiki/Function_composition">composite function</a>.</p>
</div>
</div>
<hr>
<div id="exr-prove-eq-logit" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3.23 (Compose the logit function)</strong></span> Mathematically expand the definition of the logit function.</p>
</div>
<hr>
<div id="sol-prove-eq-logit" class="proof solution">
<p><span class="proof-title"><em>Solution 3.16</em> (Compose the logit function). </span></p>
<div id="thm-logit-function" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.12 (Expanded expression for logit)</strong></span> <span id="eq-logit"><span class="math display">\[\text{logit}(\pi) = \text{log}\left\{\frac{\pi}{1-\pi}\right\} \tag{3.11}\]</span></span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Apply <a href="#def-logit-fn" class="quarto-xref">Definition&nbsp;<span>3.13</span></a> and then <a href="#def-odds" class="quarto-xref">Definition&nbsp;<span>3.8</span></a> (details left to the reader).</p>
</div>
</div>
<hr>
<div id="cor-logodds-logit" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.10</strong></span> If <span class="math inline">\(\pi\)</span> is the probability of an event <span class="math inline">\(A\)</span> and <span class="math inline">\(\eta\)</span> is the corresponding log-odds of <span class="math inline">\(A\)</span>, then:</p>
<p><span class="math display">\[\eta= \text{logit}\left\{\pi\right\}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Apply <a href="#thm-logodds-pi" class="quarto-xref">Theorem&nbsp;<span>3.11</span></a> and <a href="#thm-logit-function" class="quarto-xref">Theorem&nbsp;<span>3.12</span></a>.</p>
</div>
<hr>
<div class="notes">
<p><a href="#fig-logit" class="quarto-xref">Figure&nbsp;<span>3.3</span></a> shows the shape of the <span class="math inline">\(\text{logit}()\)</span> function.</p>
</div>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">odds</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pi</span><span class="op">)</span> <span class="va">pi</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">pi</span><span class="op">)</span></span>
<span></span>
<span><span class="va">logit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu">odds</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">logit_plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">logit</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>ends <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">.001</span>, <span class="fl">.999</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"logit(p)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"p"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">logit_plot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-logit" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-logit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: The logit function
</figcaption><div aria-describedby="fig-logit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="logistic-regression_files/figure-html/fig-logit-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<hr>
<div id="lem-d_logodds-d_odds" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 3.7</strong></span> <span class="math display">\[\frac{\partial \eta}{\partial \omega} = \frac{1-\pi}{\pi}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[
\begin{aligned}
\frac{\partial \eta}{\partial \omega}
&amp;= \frac{\partial}{\partial \omega}\log{\omega}
\\
&amp;= \omega^{-1}
\\
&amp;= \frac{1-\pi}{\pi}
\end{aligned}
\]</span></p>
</div>
<hr>
<div id="thm-deriv-logit" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.13 (Derivative of logit function)</strong></span> <span class="math display">\[\text{logit}'(\pi) = \frac{1}{(\pi)(1-\pi)}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Using <a href="#lem-d_logodds-d_odds" class="quarto-xref">Lemma&nbsp;<span>3.7</span></a>, <a href="#cor-d_odds-d_prob" class="quarto-xref">Corollary&nbsp;<span>3.2</span></a>, and the chain rule (<a href="math-prereqs.html#thm-chain-rule" class="quarto-xref">Theorem&nbsp;<span>B.25</span></a>):</p>
<p><span class="math display">\[
\begin{aligned}
\text{logit}'(\pi)
&amp;= \frac{\partial \eta}{\partial \pi}
\\
&amp;= \frac{\partial \eta}{\partial \omega} \frac{\partial \omega}{\partial \pi}
\\
&amp;= \frac{1-\pi}{\pi} \frac{1}{\left(1-\pi\right)^2}
\\
&amp;= \frac{1}{(\pi)(1-\pi)}
\end{aligned}
\]</span></p>
</div>
<hr></section><section id="the-expit-function" class="level3" data-number="3.5.2"><h3 data-number="3.5.2" class="anchored" data-anchor-id="the-expit-function">
<span class="header-section-number">3.5.2</span> The expit function</h3>
<div id="cor-prob-from-logodds" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.11</strong></span> &nbsp;</p>
<div class="notes">
<p>If <span class="math inline">\(\pi\)</span> is the probability of an event <span class="math inline">\(A\)</span>, <span class="math inline">\(\omega\)</span> is the corresponding odds of <span class="math inline">\(A\)</span>, and <span class="math inline">\(\eta\)</span> is the corresponding log-odds of <span class="math inline">\(A\)</span>, then:</p>
</div>
<p><span class="math display">\[\pi= \frac{\text{exp}\left\{\eta\right\}}{1+\text{exp}\left\{\eta\right\}}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Apply <a href="#thm-odds-to-prob" class="quarto-xref">Theorem&nbsp;<span>3.7</span></a> and then <a href="#thm-odds-from-logodds" class="quarto-xref">Theorem&nbsp;<span>3.10</span></a>.</p>
</div>
<hr>
<div id="def-expit" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.14 (expit, logistic, inverse-logit)</strong></span> The <strong>expit function</strong> of a log-odds <span class="math inline">\(\eta\)</span>, also known as the <strong>inverse-logit function</strong> or <strong>logistic function</strong>, is the <a href="#def-inv-odds">inverse-odds</a> of the exponential of <span class="math inline">\(\eta\)</span>:</p>
<p><span class="math display">\[\text{expit}(\eta) \stackrel{\text{def}}{=}\text{odds}^{-1}\left\{\text{exp}\left\{\eta\right\}\right\}\]</span></p>
</div>
<hr>
<div id="thm-expit-expressions" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.14 (Expressions for expit function)</strong></span> <span class="math display">\[
\begin{aligned}
\text{expit}(\eta)
   &amp;= \frac{\text{exp}\left\{\eta\right\}}{1+\text{exp}\left\{\eta\right\}}
\\ &amp;= \frac{1}{1 + \text{exp}\left\{-\eta\right\})}
\\ &amp;= (1 + \text{exp}\left\{-\eta\right\})^{-1}
\end{aligned}
\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Apply definitions and <a href="#lem-invodds-simplified" class="quarto-xref">Lemma&nbsp;<span>3.3</span></a>. Details left to the reader.</p>
</div>
<hr>
<div id="thm-expit-prob-logodds" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.15</strong></span> If <span class="math inline">\(\pi\)</span> is the probability of an event <span class="math inline">\(A\)</span>, <span class="math inline">\(\omega\)</span> is the corresponding odds of <span class="math inline">\(A\)</span>, and <span class="math inline">\(\eta\)</span> is the corresponding log-odds of <span class="math inline">\(A\)</span>, then:</p>
<p><span class="math display">\[\pi= \text{expit}\left\{\eta\right\}\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Apply <a href="#cor-prob-from-logodds" class="quarto-xref">Corollary&nbsp;<span>3.11</span></a> and <a href="#thm-expit-expressions" class="quarto-xref">Theorem&nbsp;<span>3.14</span></a>.</p>
</div>
<hr>
<p><a href="#fig-expit-plot" class="quarto-xref">Figure&nbsp;<span>3.4</span></a> graphs the expit function.</p>
<div class="cell">
<details class="code-fold"><summary>Show R code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">expit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">expit_plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">expit</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>ends <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">expit</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">expit_plot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-expit-plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-expit-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: The expit function
</figcaption><div aria-describedby="fig-expit-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="logistic-regression_files/figure-html/fig-expit-plot-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<hr>
<div id="thm-logit-expit" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.16 (logit and expit are each others’ inverses)</strong></span> <span class="math display">\[\text{logit}\left\{\text{expit}\left\{\eta\right\}\right\} = \eta\]</span></p>
<p><span class="math display">\[\text{expit}\left\{\text{logit}\left\{\pi\right\}\right\} = \pi\]</span></p>
</div>
<hr>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Left to the reader.</p>
</div>
<hr>
<p>&lt;!–</p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-dobson4e" class="csl-entry" role="listitem">
Dobson, Annette J, and Adrian G Barnett. 2018. <em>An Introduction to Generalized Linear Models</em>. 4th ed. CRC press. <a href="https://doi.org/10.1201/9781315182780">https://doi.org/10.1201/9781315182780</a>.
</div>
<div id="ref-NahhasIRMPHR" class="csl-entry" role="listitem">
Nahhas, Ramzi W. 2024. <em>Introduction to Regression Methods for Public Health Using <span>R</span></em>. CRC Press. <a href="https://www.bookdown.org/rwnahhas/RMPH/">https://www.bookdown.org/rwnahhas/RMPH/</a>.
</div>
<div id="ref-vittinghoff2e" class="csl-entry" role="listitem">
Vittinghoff, Eric, David V Glidden, Stephen C Shiboski, and Charles E McCulloch. 2012. <em>Regression Methods in Biostatistics: Linear, Logistic, Survival, and Repeated Measures Models</em>. 2nd ed. Springer. <a href="https://doi.org/10.1007/978-1-4614-1353-0">https://doi.org/10.1007/978-1-4614-1353-0</a>.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./Linear-models-overview.html" class="pagination-link" aria-label="Linear (Gaussian) Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Linear (Gaussian) Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./count-regression.html" class="pagination-link" aria-label="Models for Count Outcomes">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Models for Count Outcomes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
 Copyright 2024, Douglas Ezra Morrison
  </li>  
</ul>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/d-morrison/rme/edit/main/logistic-regression.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/d-morrison/rme/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/d-morrison/rme/blob/main/logistic-regression.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>